<div class="page-header">
    <h1>{{course.course_payload.title}} Home Page</h1>
</div>

<div class="col-md-3">
    <div class="panel panel-info">
        <div class="panel-heading" style="text-align: center;">
            <strong>Instructors</strong>
        </div>
        <table class="table table-bordered">
            <tr ng-repeat="instructor in course.course_payload.instructors">
                <td>{{instructor.username}}</td>
            </tr>
        </table>
    </div>

    <div class="panel panel-info">
        <div class="panel-heading" style="text-align: center;">
            <strong>Teaching Assistants</strong>
        </div>
        <table class="table table-bordered">
            <tr ng-repeat="ta in course.course_payload.tas">
                <td>{{ta.username}}</td>
            </tr>
        </table>
    </div>

    <div ng-show="course.url.usertype !== 'student'" class="panel panel-info">
        <div class="panel-heading" style="text-align: center;">
            <strong>Students</strong>
        </div>
        <table class="table table-bordered">
            <tr ng-repeat="student in course.course_payload.students">
                <td>{{student.username}}</td>
            </tr>
        </table>
    </div>
</div>

<div class="col-md-9" style="float: right">
    <div class="panel panel-info">
        <div class="panel-heading" style="text-align: center;">
            <strong>Announcements</strong>
            <button ng-show="course.url.usertype !== 'student'" type="button" style="float: right" data-toggle="modal" data-target="#AddAnnouncementsModal">+</button>
        </div>
        <table class="table table-bordered">
            <tr>
                <td><strong>Posted By</strong></td>
                <td><strong>Summary</strong></td>
                <td><strong>Time</strong></td>
            </tr>
            <tr ng-repeat="announcement in course.course_payload.announcements">
                <td>{{announcement.postedBy}}</td>
                <td>{{announcement.description}}</td>
                <td>{{announcement.timestamp | date : "MM/dd/yyyy 'at' h:mm a" }}</td> <!-- TODO: add due date correctly! -->
                <!-- <td ng-show="!assignment.isSubmitted"><button type="button" class="btn btn-primary">Submit</button></td> -->
            </tr>
        </table>
    </div>

    <div class="panel panel-info">
        <div class="panel-heading" style="text-align: center;">
            <strong>Current Assignments</strong>
            <button ng-show="course.url.usertype === 'instructor'" type="button" style="float: right" data-toggle="modal" data-target="#AddAssignmentsModal">+</button>
        </div>
        <table class="table table-bordered">
            <tr>
                <td><strong>Assignment</strong></td>
                <td><strong>Assigned</strong></td>
                <td><strong>Due Date</strong></td>
            </tr>
            <tr ng-repeat="assignment in course.course_payload.assignments | filter: {pastDue: 'false'}">
                <td ng-show="course.url.usertype === 'student'"><a ng-click="course.openDocument(assignment.id, main.profile_payload.data.student_profile.id, assignment)">{{assignment.title}}</a></td>
                <td ng-show="course.url.usertype !== 'student'">{{assignment.title}}</td>
                <td>{{assignment.timestamp | date : "MM/dd/yyyy 'at' h:mm a" }}</td>
                <td>{{assignment.dueDate | date : "MM/dd/yyyy 'at' h:mm a" }}</td> <!-- TODO: add due date correctly! -->
                <!-- <td ng-show="!assignment.isSubmitted"><button type="button" class="btn btn-primary">Submit</button></td> -->
            </tr>
        </table>
    </div>

    <!-- TODO: fix display -->
    <div class="panel panel-info">
        <div class="panel-heading" style="text-align: center;"><strong>Past Assignments</strong></div>
        <table class="table table-bordered">
            <tr>
                <td><strong>Assignment</strong></td>
                <td><strong>Due Date</strong></td>
                <td><strong>Grade</strong></td>
            </tr>
            <tr ng-repeat="assignment in course.course_payload.assignments | filter: {pastDue: 'true'}">
                <td ng-show="course.url.usertype == 'student'">{{assignment.title}}</td>
                <td ng-show="course.url.usertype != 'student'">{{assignment.title}}</td>
                <td>{{assignment.dueDate | date : "MM/dd/yyyy 'at' h:mm a"}}</td>
                <td ng-show="assignment.grade !== -1">{{assignment.grade}}</td>
                <td ng-show="!assignment.isGraded">Needs Grading</td>
            </tr>
        </table>
    </div>
</div>

<div> <!-- TODO : Not sure about this for checking if teacher -->
    <div class="modal fade" id="AddAnnouncementsModal" tabindex="-1" role="dialog" aria-labelledby="AddAnnouncementsModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="AddAnnouncementsModalLabel">New Announcement</h4>
                </div>
                <div class="modal-body">
                    <form ng-submit="course.addAnnouncement(description, main.profile_payload.data.user.username, course.course_payload.id)">
                        <div class="form-group">
                            <label for="assignmentDescription" class="control-label">Assignment Description</label>
                            <textarea name="description" class="form-control" id="announcementDescription" ng-model="description"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Create Announcement</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div> <!-- TODO : Not sure about this for checking if teacher -->
    <div class="modal fade" id="AddAssignmentsModal" tabindex="-1" role="dialog" aria-labelledby="AddAssignmentsModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="AddAssignmentsModalLabel">New Assignment</h4>
                </div>
                <div class="modal-body">
                    <form ng-submit="course.addAssignment(title, description, dueDate, time, course.course_payload.id)">
                        <div class="form-group">
                            <label for="assignmentTitle" class="control-label">Assignment Title</label>
                            <input name="title" type="text" class="form-control" id="assignmentTitle" ng-model="title">
                        </div>
                        <div class="form-group">
                            <label for="assignmentDescription" class="control-label">Assignment Description</label>
                            <textarea name="description" class="form-control" id="assignmentDescription" ng-model="description"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="assignmentDate" class="control-label">Assignment Due Date</label>
                            <input name="dueDate" type="date" class="form-control" id="assignmentDate" ng-model="dueDate">
                            <label for="assignmentTime" class="control-label">Time Due</label>
                            <input name="time" type="time" class="form-control" id="assignmentTime" ng-model="time">
                        </div>
                        <button type="submit" class="btn btn-primary">Create Assignment</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>